#!/bin/bash

set -e

source ${1}


if [ -z ${git_dir} ]; then echo "git_dir is not set"; exit -1; fi

REPO_DIR=${git_dir}/.git

if [[ ! -d $REPO_DIR ]]; then 
  echo "message='git_dir seems not to be a respository'"
  echo "current_git_ref=nil"
else
  echo "current_git_ref=$(cd ${git_dir}; git show-ref --heads --head -s | head -n 1)"
fi

exit 0
